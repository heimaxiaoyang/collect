import{g as b,j as y,o as p,p as d,m as I,aM as _,q as v,v as k,l as R,Z as G,k as A,a as X,w as m,$ as S,b as u,aJ as E,I as M,aK as P,f as Y,z as H,ac as L,d as D}from"./index-D_2n3_og.js";const j={name:"el-color-picker",props:{value:{type:String,default:"#ff0000"},disabled:{type:Boolean,default:!1},showAlpha:{type:Boolean,default:!1},colorFormat:{type:String,default:"hex"}},data(){return{canvasId:"canvas-"+Date.now(),curId:"cur-"+Date.now(),barId:"bar-"+Date.now(),alphaId:"alpha-"+Date.now(),canvas:null,ctx:null,curColor:"",activeColor:"",alpha:1,width:286,height:200,showPanel:!1}},computed:{alphaBarStyle(){return"background: linear-gradient(to right, rgba(255, 69, 0, 0) 0%, "+this.activeColor+" 100%);"}},watch:{value(e){this.curColor=e,this.resetCurColor()}},created(){var e=this;this.handler=function(t){e.showPanel=!1},document.body.addEventListener("click",this.handler),this.$nextTick(()=>{this.curColor=this.value,this.activeColor="#ff0000",this.resetCurColor(),this.init()})},beforeDestroy(){document.body.removeEventListener("click",this.handler)},methods:{init(){this.canvas=document.getElementById(this.canvasId),this.ctx=this.canvas.getContext("2d"),this.makeColorBar(),this.makeColorBox("#ff0000")},makeColorBar(){var e=this.ctx.createLinearGradient(0,0,0,this.height);e.addColorStop(0,"#f00"),e.addColorStop(1/6,"#f0f"),e.addColorStop(2/6,"#00f"),e.addColorStop(3/6,"#0ff"),e.addColorStop(4/6,"#0f0"),e.addColorStop(5/6,"#ff0"),e.addColorStop(1,"#f00"),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,20,this.height)},makeColorBox(e){var t=this.ctx.createLinearGradient(30,0,this.width,0);t.addColorStop(1,e),t.addColorStop(0,"rgba(255,255,255,1)"),this.ctx.fillStyle=t,this.ctx.fillRect(30,0,this.width,this.height);var o=this.ctx.createLinearGradient(0,0,0,this.height);o.addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),this.ctx.fillStyle=o,this.ctx.fillRect(30,0,this.width,this.height)},onCanvasClick(e){var t={x:e.offsetX||e.layerX,y:e.offsetY||e.layerY},o="#000";if(t.x>=0&&t.x<20){o=this.getRgbaAtPoint(t,"bar");var a=document.getElementById(this.barId);a.style.top=t.y+"px",this.makeColorBox("rgb("+o.slice(0,3).join()+")"),this.$emit("active-change",this.rgb2hex("rgba("+o.slice(0,3).join()+","+this.alpha+")"))}else if(t.x>=30){o=this.getRgbaAtPoint(t,"box");var n=document.getElementById(this.curId);n.style.left=t.x+"px",n.style.top=t.y+"px"}else return;this.setCurColor(o)},onCanvasMousedown(e,t){var o=this,a={x:e.layerX||e.offsetX,y:e.layerY||e.offsetY},n=parseInt(e.target.offsetTop),i=parseInt(e.target.offsetLeft);if(t==="cur"||a.x>=30&&a.x<30+this.width&&a.y>=0&&a.y<this.height){var r=document.getElementById(this.curId);document.onmouseup=function(){document.onmouseup=document.onmousemove=null},document.onmousemove=function(s){try{var l={x:s.clientX-e.clientX+e.offsetX+i,y:s.clientY-e.clientY+e.offsetY+n};l.x=l.x<=30?30:l.x&&(l.x>o.width?o.width:l.x),l.y=l.y<=0?0:l.y&&(l.y>o.height?o.height:l.y);var f=o.getRgbaAtPoint(l,"box");o.setCurColor(f),r.style.left=l.x+"px",r.style.top=l.y+"px"}catch(g){console.log(g)}}}else if(a.x<=20&&a.y<=this.height){var h=document.getElementById(this.barId);document.onmouseup=function(){document.onmouseup=document.onmousemove=null},document.onmousemove=function(s){try{var l={x:0,y:s.clientY-e.clientY+e.offsetY+n};l.y=l.y<=0?0:l.y&&(l.y>o.height?o.height:l.y);var f=o.getRgbaAtPoint(l,"box");h.style.top=l.y+"px",o.activeColor=o.rgb2hex("rgb("+f.slice(0,3).join()+")"),o.makeColorBox("rgb("+f.slice(0,3).join()+")"),o.$emit("active-change",o.activeColor)}catch(g){console.log(g)}}}},onAlphaClick(e){var t=e.offsetX||e.layerX,o=document.getElementById(this.alphaId),a=o.parentNode;this.alpha=parseFloat(t/a.clientWidth).toFixed(2),this.resetCurColor()},onAlphaMousedown(e){var t=this;e.layerX||e.offsetX,e.layerY||e.offsetY,parseInt(e.target.offsetTop);var o=parseInt(e.target.offsetLeft),a=document.getElementById(this.alphaId),n=a.parentNode;document.onmouseup=function(){document.onmouseup=document.onmousemove=null},document.onmousemove=function(i){try{var r={x:i.clientX-e.clientX+e.offsetX+o,y:0};r.x=r.x<=0?0:r.x&&(r.x>n.clientWidth?n.clientWidth:r.x),t.alpha=parseFloat(r.x/n.clientWidth).toFixed(2),t.resetCurColor()}catch(h){console.log(h)}}},resetCurColor(){var e=this.curColor,t=this.alpha,o=/^(rgb|RGB)/;o.test(e)||(e=this.hex2rgb(e.slice(0,7)));var a=e.replace(/(?:rgba|rgb|RGBA|RGB|\(|\))*/g,"").split(",");a[3]=t,this.setCurColor(a)},setCurColor(e){var t="a";(e.length===4&&e[3]=="1"||!this.showAlpha)&&(e=e.slice(0,3),t=""),this.colorFormat==="hex"?this.curColor=this.rgb2hex("rgb"+t+"("+e.join()+")"):this.colorFormat==="rgb"&&(this.curColor="rgb"+t+"("+e.join()+")"),this.$emit("input",this.curColor),this.sendChange()},confirm(){this.sendChange(),this.showPanel=!1},sendChange(){this.$emit("change",this.curColor)},getRgbaAtPoint(e,t){if(t=="bar")var o=this.ctx.getImageData(0,0,20,this.height);else var o=this.ctx.getImageData(0,0,this.width,this.height);var a=o.data,n=(e.y*o.width+e.x)*4;return e.x>=30&&e.y>this.height-3?[0,0,0,this.alpha]:(e.x>=30&&e.y<=1&&(a[n]=255),e.x>=30&&e.x<=31?[a[n],a[n],a[n],this.alpha]:e.x>=this.width-1?[a[n],0,0,this.alpha]:[a[n],a[n+1],a[n+2],this.alpha])},rgb2hex(e){var t=/^(rgb|RGB)/,o;if(t.test(e)){var a=e.replace(/(?:rgba|rgb|RGBA|RGB|\(|\))*/g,"").split(","),n=(a&&a[3]||"").trim(),i="#"+((1<<24)+(parseInt(a[0])<<16)+(parseInt(a[1])<<8)+parseInt(a[2])).toString(16).slice(1);return n!=""&&n!="1"&&(o=(n*255|256).toString(16).slice(1),i=i+o),i}else return e},hex2rgb(e){var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,o=e.toLowerCase();if(t.test(o)){if(o.length===4){for(var a="#",n=1;n<o.length;n+=1)a+=o.slice(n,n+1).concat(o.slice(n,n+1));o=a}for(var i=[],n=1;n<o.length;n+=2)i.push(parseInt("0x"+o.slice(n,n+2)));return"rgb("+i.join(",")+")"}else return o}}},F={class:"c__color-picker"},N={class:"c__canvas"},T=["id","width","height"],U=["id"],V=["id"],W={key:0,class:"c__alpha-silder"},z=["id"],q={class:"c__control"},J=["value"],K={class:"c__btns"};function Z(e,t,o,a,n,i){return p(),y("div",F,[d("div",{class:"c__block",style:v({backgroundColor:n.curColor}),onClick:t[0]||(t[0]=_(r=>!o.disabled&&(n.showPanel=!0),["stop"]))},null,4),I(d("div",{class:"c__panel",onClick:t[10]||(t[10]=_(()=>{},["stop"]))},[d("div",N,[d("canvas",{id:n.canvasId,width:n.width,height:n.height,onClick:t[1]||(t[1]=(...r)=>i.onCanvasClick&&i.onCanvasClick(...r)),onMousedown:t[2]||(t[2]=(...r)=>i.onCanvasMousedown&&i.onCanvasMousedown(...r))},null,40,T),d("em",{class:"c__cur",id:n.curId,onMousedown:t[3]||(t[3]=function(r){i.onCanvasMousedown(r,"cur")})},null,40,U),d("em",{class:"c__bar",id:n.barId,onMousedown:t[4]||(t[4]=function(r){i.onCanvasMousedown(r,"bar")})},null,40,V),o.showAlpha?(p(),y("div",W,[d("div",{class:"c__alpha-silder-bar",style:v(i.alphaBarStyle),onClick:t[5]||(t[5]=(...r)=>i.onAlphaClick&&i.onAlphaClick(...r)),onMousedown:t[6]||(t[6]=(...r)=>i.onAlphaMousedown&&i.onAlphaMousedown(...r))},null,36),d("em",{class:"c__alpha",id:n.alphaId,style:v({left:n.alpha*100+"%"}),onMousedown:t[7]||(t[7]=(...r)=>i.onAlphaMousedown&&i.onAlphaMousedown(...r))},null,44,z)])):R("",!0)]),d("div",q,[d("input",{class:"c__input",value:n.curColor},null,8,J),d("div",K,[d("div",{class:"c__btn-clear",onClick:t[8]||(t[8]=r=>n.curColor="")},"清空"),d("div",{class:"c__btn-confirm",onClick:t[9]||(t[9]=(...r)=>i.confirm&&i.confirm(...r))},"确定")])])],512),[[k,n.showPanel]])])}const x=b(j,[["render",Z]]),C=function(e){C.installed||e.component(x.name,x)};typeof window<"u"&&window.Vue&&C(window.Vue);const O={install:C,...x},Q={__name:"index",setup(e){const t=G({R:0,G:0,B:0,A:1,HEX:""}),o=h=>{t.HEX=h;const{R:s,G:l,B:f}=n(t.HEX);t.R=s,t.G=l,t.B=f};function a(h,s,l){return`#${((1<<24)+(h<<16)+(s<<8)+l).toString(16).slice(1).toUpperCase()}`}function n(h){const s=h.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);return s?{R:parseInt(s[1],16),G:parseInt(s[2],16),B:parseInt(s[3],16)}:{R:0,G:0,B:0}}function i(){t.HEX=a(t.R,t.G,t.B)}function r(){const{R:h,G:s,B:l}=n(t.HEX);t.R=h,t.G=s,t.B=l}return A([()=>t.R,()=>t.G,()=>t.B],i,{immediate:!0}),(h,s)=>{const l=E,f=M,g=S,w=P,B=L;return p(),X(g,{direction:"vertical",style:{width:"100%"}},{default:m(()=>[u(g,null,{default:m(()=>[u(l,{value:t.R,"onUpdate:value":s[0]||(s[0]=c=>t.R=c),min:0,max:255,prefix:"R",onChange:i},null,8,["value"]),u(l,{value:t.G,"onUpdate:value":s[1]||(s[1]=c=>t.G=c),min:0,max:255,prefix:"G",onChange:i},null,8,["value"]),u(l,{value:t.B,"onUpdate:value":s[2]||(s[2]=c=>t.B=c),min:0,max:255,prefix:"B",onChange:i},null,8,["value"]),u(l,{value:t.A,"onUpdate:value":s[3]||(s[3]=c=>t.A=c),min:0,max:1,step:"0.1",prefix:"A",onChange:i},null,8,["value"]),u(f,{value:t.HEX,"onUpdate:value":s[4]||(s[4]=c=>t.HEX=c),"addon-before":"HEX 值",onChange:r},null,8,["value"])]),_:1}),u(w,null,{default:m(()=>[Y(H(`结果: rgba(${t.R}, ${t.G}, ${t.B},${t.A})`),1)]),_:1}),u(B,{gap:"middle"},{default:m(()=>[d("div",{class:"color-box",style:v({backgroundColor:`rgba(${t.R}, ${t.G}, ${t.B},${t.A})`})},null,4),d("div",null,[u(D(O),{value:t.HEX,onChange:o},null,8,["value"])])]),_:1})]),_:1})}}},tt=b(Q,[["__scopeId","data-v-e1af71e4"]]);export{tt as default};
